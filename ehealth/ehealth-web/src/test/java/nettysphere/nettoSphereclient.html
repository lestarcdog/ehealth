<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
<script type="text/javascript" src="../../../main/webapp/js/framework/jquery-2.1.3.js"></script>
<script type="text/javascript"	src="../../../main/webapp/js/framework/atmosphere.jquery.js"></script>
</head>
<body>
<div id="content">valami</div>


<script type="text/javascript">
	var content = $("#content");
	var socket = $.atmosphere;
	var request = {
		url : "http://127.0.0.1:9090/test",
		logLevel : 'debug',
		transport : 'websocket',
		fallbackTransport : 'long-polling'
	};

	request.onOpen = function(response) {
		content.html($('<p>', {
			text : 'Atmosphere connected using ' + response.transport
		}));
		setInterval(function () {
			subSocket.push("client");
		}, 3000);
	};

	request.onMessage = function(response) {
		var message = response.responseBody;
		try {
			console.log(message);
			content.html(content.html() + message);

		} catch (e) {
			console.log('This does not look like a valid JSON: ', message.data);
			return;
		}
	};

	request.onError = function(response) {
		console.log(response)
	};

	var subSocket = socket.subscribe(request);

	
</script>


</body>
</html>